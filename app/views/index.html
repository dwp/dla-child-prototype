{% extends "layouts/main.html" %}
{% block footer %}
  {% include "includes/regular-footer.njk" %}
{% endblock %}

{% set pageName="Home" %}

{% block header %}
{{ super() }}
{% from "govuk/components/service-navigation/macro.njk" import govukServiceNavigation %}
 
{% endblock %}
 

{% block content %}

<div class="govuk-grid-row">
  
  <h1 class="govuk-heading-xl">
      DLA child: supporting information 
    </h1>

  <form id="my-form" method="post" novalidate>

  <div class="govuk-form-group" id="radio-group">
  <fieldset class="govuk-fieldset" aria-describedby="radio-error">
    <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
      <h1 class="govuk-fieldset__heading">Select a prototype </h1>
    </legend>
    
    <p id="radio-error" class="govuk error-message govuk-visually-hidden">
      <span class="govuk-visually-hidden">Error;</span>Select an option 
    </p>

    <div class="govuk-radios">
      <div class="govuk-radios__item">
        <input class="govuk-radios__input" id="opt1" name="goto" type="radio" data-href="evidence-gathering6/cms-view/dashboard">
        <label class="govuk-label govuk-radios__label" for="opt1">Case Manager </label>
        <div id="signIn-item-hint" class="govuk-hint govuk-radios__hint">
          Send a new request to the school with the child's details and view existing cases.
        </div>
      </div>

      <div class="govuk-radios__item">
        <input class="govuk-radios__input" id="opt2" name="goto" type="radio" data-href="evidence-gathering7/schools-view/email">
        <label class="govuk-label govuk-radios__label" for="opt2">
         Educational Professional
        </label>
        <div id="signIn-2-item-hint" class="govuk-hint govuk-radios__hint">
          View the supporting information email sent to the school and provide supporting information about the child.
        </div>
      </div>
    </div>
  </fieldset>
</div>
<button class="govuk-button" type="submit">Continue</button>
</form>

<!-- Logic for radio routes -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('my-form');
    const radios = form.querySelectorAll('.govuk-radios__input');
    const formGroup = document.getElementById('radio-group');
    const errorMessage = document.getElementById('radio-error');

    let selectedHref = null;

    radios.forEach(radio => {
      radio.addEventListener('change', () => {
        selectedHref = radio.dataset.href;

        formGroup.classList.remove('govuk-form-group--error');
        errorMessage.classList.add('govuk-visually-hidden');
        radios.forEach(r => r.classList.remove('govuk-input--error'));
      });
    });

    form.addEventListener('submit', (e) => {
      console.log("selected href:", selectedHref);
      if (!selectedHref) {
        e.preventDefault();

        formGroup.classList.add('govuk-form-group--error');
        errorMessage.classList.remove('govuk-visually-hidden');
        radios.forEach(radio => {
          radio.classList.add('govuk-input--error');
        });

        errorMessage.focus();
        return;
      }

      e.preventDefault();
      window.location.href = selectedHref;
      });
    });
  </script>

<br/>
</div>


{% endblock %}
